$sgeo_lat=jQuery('.sgeo_lat'),$sgeo_lon=jQuery('.sgeo_lon');jQuery('.geodir_reset').click(function(){lat=SH_DEFAULT_LOC_LAT;lon=SH_DEFAULT_LOC_LON;navigator.geolocation.getCurrentPosition(function(position){lat=position.coords.latitude;lon=position.coords.longitude;sh_reload_page(0);},function(error){sh_reload_page(1);});return false;});function sh_geolocate(){if($sgeo_lat.val()&&$sgeo_lon.val()){lat=$sgeo_lat.val();lon=$sgeo_lon.val();console.log('URL Location');sh_reload_page(0);}else if(navigator.geolocation){console.log('HTML5 Geolocation');navigator.geolocation.getCurrentPosition(function(position){lat=position.coords.latitude;lon=position.coords.longitude;sh_reload_page(0);},function(error){sh_reload_page(error);});}}
function sh_reload_page(error){my_location=1;if(error===0){$sgeo_lat.val(lat);$sgeo_lon.val(lon);}else{alert(SH_ERROR_GEOLOCATION+': '+error);console.log('Default Location');$sgeo_lat.val(lat=SH_DEFAULT_LOC_LAT);$sgeo_lon.val(lon=SH_DEFAULT_LOC_LON);}
if(typeof gdSetupUserLoc==='function'){gdSetupUserLoc();}else{gdLocationSetupUserLoc();}
jQuery.ajax({url:SH_AJAX_ADMIN_URL,type:'POST',dataType:'html',data:{action:'gd_location_manager_set_user_location',lat:lat,lon:lon,myloc:1},beforeSend:function(){},success:function(data,textStatus,xhr){jQuery('#guiden-filter').submit();},error:function(xhr,textStatus,errorThrown){alert(textStatus);}});};